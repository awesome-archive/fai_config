#! /bin/bash

# (c) Thomas Lange, 2001-2015, lange@debian.org
# (c) Michael Goetze, 2010-2011, mgoetze@mgoetze.net

error=0; trap 'error=$(($?>$error?$?:$error))' ERR # save maximum error code

cat > $target/etc/apt/sources.list.d/gitlab-ce.list <<-EOF
# this file was generated by packages.gitlab.com for
# the repository at https://packages.gitlab.com/gitlab/gitlab-ce

#deb https://packages.gitlab.com/gitlab/gitlab-ce/debian/ jessie main
#deb-src https://packages.gitlab.com/gitlab/gitlab-ce/debian/ jessie main
deb https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/debian jessie main
deb-src https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/debian jessie main
EOF

#cat > $target/etc/apt/sources.list.d/gitlab-ci-multi-runner.list <<-EOF
# this file was generated by packages.gitlab.com for
# the repository at https://packages.gitlab.com/runner/gitlab-ci-multi-runner

#deb https://packages.gitlab.com/runner/gitlab-ci-multi-runner/debian/ jessie main
#deb-src https://packages.gitlab.com/runner/gitlab-ci-multi-runner/debian/ jessie main
#deb https://mirrors.tuna.tsinghua.edu.cn/gitlab-ci-multi-runner/debian jessie main
#deb-src https://mirrors.tuna.tsinghua.edu.cn/gitlab-ci-multi-runner/debian jessie main
#EOF

$ROOTCMD apt-get update 
$ROOTCMD apt-get install -y gitlab-ce
#$ROOTCMD apt-get install -y gitlab-ci-multi-runner

exit $error
